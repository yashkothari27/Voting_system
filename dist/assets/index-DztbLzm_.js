import{r as U,a as B,g as G,b as a,L as R,H,R as J,d as C,e as K}from"./vendor-B4YgLCem.js";import{W as E}from"./web3-DlgSA-qn.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))d(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const u of r.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&d(u)}).observe(document,{childList:!0,subtree:!0});function o(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function d(s){if(s.ep)return;s.ep=!0;const r=o(s);fetch(s.href,r)}})();var V={exports:{}},N={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var O;function $(){if(O)return N;O=1;var t=U(),n=Symbol.for("react.element"),o=Symbol.for("react.fragment"),d=Object.prototype.hasOwnProperty,s=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,r={key:!0,ref:!0,__self:!0,__source:!0};function u(c,i,m){var l,p={},f=null,x=null;m!==void 0&&(f=""+m),i.key!==void 0&&(f=""+i.key),i.ref!==void 0&&(x=i.ref);for(l in i)d.call(i,l)&&!r.hasOwnProperty(l)&&(p[l]=i[l]);if(c&&c.defaultProps)for(l in i=c.defaultProps,i)p[l]===void 0&&(p[l]=i[l]);return{$$typeof:n,type:c,key:f,ref:x,props:p,_owner:s.current}}return N.Fragment=o,N.jsx=u,N.jsxs=u,N}var L;function Y(){return L||(L=1,V.exports=$()),V.exports}var e=Y(),S={},P;function z(){if(P)return S;P=1;var t=B();return S.createRoot=t.createRoot,S.hydrateRoot=t.hydrateRoot,S}var Q=z();const X=G(Q),Z=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"voter",type:"address"}],name:"VoterRegistered",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"voter",type:"address"},{indexed:!0,internalType:"uint256",name:"candidateId",type:"uint256"}],name:"VoteCast",type:"event"},{inputs:[{internalType:"string",name:"_name",type:"string"}],name:"addCandidate",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"admin",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_candidateId",type:"uint256"}],name:"castVote",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_id",type:"uint256"}],name:"getCandidate",outputs:[{internalType:"uint256",name:"",type:"uint256"},{internalType:"string",name:"",type:"string"},{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getCandidateCount",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_voter",type:"address"}],name:"registerVoter",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"voters",outputs:[{internalType:"bool",name:"isRegistered",type:"bool"},{internalType:"bool",name:"hasVoted",type:"bool"},{internalType:"uint256",name:"votedCandidateId",type:"uint256"}],stateMutability:"view",type:"function"}],ee={abi:Z},_={CONTRACT_ADDRESS:"0x56A1f9FB1B7a1d71e2660279A7bF390866c88bf0",NETWORK_ID:parseInt("32323"),API_URL:"https://mainnet.reltime.com"},te={RTC_MAINNET:{chainId:"0x7e43",chainName:"RTC Mainnet",nativeCurrency:{name:"RTC",symbol:"RTC",decimals:18},rpcUrls:["https://mainnet.reltime.com"],blockExplorerUrls:["https://explorer.reltime.com"]}},q="0x56A1f9FB1B7a1d71e2660279A7bF390866c88bf0",b={UNREGISTERED:"UNREGISTERED",REGISTERED:"REGISTERED",VERIFIED:"VERIFIED",VOTED:"VOTED"},M=async()=>{let t=null;if(window.ethereum){t=new E(window.ethereum);try{if(await window.ethereum.request({method:"eth_requestAccounts"}),await t.eth.getChainId()!==_.NETWORK_ID)try{await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:E.utils.toHex(_.NETWORK_ID)}]})}catch(o){if(o.code===4902)await window.ethereum.request({method:"wallet_addEthereumChain",params:[te.RTC_MAINNET]});else throw o}}catch{throw new Error("User denied account access or network switch failed")}}else if(window.web3)t=new E(window.web3.currentProvider);else{const n=new E.providers.HttpProvider(_.API_URL);t=new E(n)}return t},ne=async t=>{const n=await M();if(!E.utils.isAddress(t))throw new Error("Invalid contract address");return new n.eth.Contract(ee.abi,t)},F=a.createContext(null);function se({children:t}){const[n,o]=a.useState(null),[d,s]=a.useState(null),[r,u]=a.useState(null),[c,i]=a.useState(!0),[m,l]=a.useState(null);return a.useEffect(()=>((async()=>{var f,x;try{const h=await M(),y=await h.eth.getAccounts();if(!y||y.length===0)throw new Error("No accounts found. Please connect your wallet.");const w=await ne(q);if(!w.methods.voters||!w.methods.getCandidate)throw new Error("Contract missing required methods");o(h),s(w),u(y[0]),(f=window.ethereum)==null||f.on("accountsChanged",I=>{u(I[0])}),(x=window.ethereum)==null||x.on("chainChanged",()=>{window.location.reload()})}catch(h){l(h.message),console.error("Failed to initialize Web3:",h)}finally{i(!1)}})(),()=>{window.ethereum&&(window.ethereum.removeListener("accountsChanged",()=>{}),window.ethereum.removeListener("chainChanged",()=>{}))}),[]),c?e.jsx("div",{children:"Loading Web3..."}):m?e.jsxs("div",{children:["Error: ",m]}):e.jsx(F.Provider,{value:{web3:n,contract:d,account:r,loading:c,error:m},children:t})}function A(){const t=a.useContext(F);if(!t)throw new Error("useWeb3 must be used within a Web3Provider");return t}function re(){return e.jsx("nav",{className:"navbar",children:e.jsxs("div",{className:"navbar-container",children:[e.jsx(R,{to:"/",className:"navbar-logo",children:"Blockchain Voting"}),e.jsxs("div",{className:"nav-links",children:[e.jsx(R,{to:"/register",className:"nav-link",children:"Register"}),e.jsx(R,{to:"/vote",className:"nav-link",children:"Vote"}),e.jsx(R,{to:"/results",className:"nav-link",children:"Results"})]})]})})}function ae(){return e.jsxs("div",{className:"home",children:[e.jsx("h1",{children:"Secure Blockchain Voting System"}),e.jsx("p",{className:"subtitle",children:"Vote securely and transparently using blockchain technology"}),e.jsxs("div",{className:"features",children:[e.jsxs("div",{className:"feature",children:[e.jsx("h3",{children:"Decentralized"}),e.jsx("p",{children:"Powered by Ethereum blockchain for maximum security"})]}),e.jsxs("div",{className:"feature",children:[e.jsx("h3",{children:"Transparent"}),e.jsx("p",{children:"All votes are publicly verifiable"})]}),e.jsxs("div",{className:"feature",children:[e.jsx("h3",{children:"Immutable"}),e.jsx("p",{children:"Votes cannot be altered once cast"})]})]}),e.jsxs("div",{className:"cta-buttons",children:[e.jsx(R,{to:"/register",className:"button",children:"Register to Vote"}),e.jsx(R,{to:"/vote",className:"button",children:"Cast Your Vote"})]})]})}const ie=()=>{const{contract:t,account:n}=A(),[o,d]=a.useState(!1),[s,r]=a.useState(null);return{castVote:a.useCallback(async c=>{d(!0),r(null);try{return await t.methods.castVote(c).send({from:n})}catch(i){throw r(i.message),i}finally{d(!1)}},[t,n]),loading:o,error:s}};function W({size:t="medium",message:n="Loading..."}){return e.jsxs("div",{className:`loading-spinner ${t}`,children:[e.jsx("div",{className:"spinner-ring"}),e.jsx("p",{className:"spinner-message",children:n})]})}function D({message:t}){return e.jsx("div",{className:"error-message",children:e.jsx("p",{children:t})})}function oe(){const{contract:t,account:n}=A(),{castVote:o,loading:d,error:s}=ie(),[r,u]=a.useState([]),[c,i]=a.useState(""),[m,l]=a.useState(b.UNREGISTERED),[p,f]=a.useState(null),[x,h]=a.useState(!0),[y,w]=a.useState(null);a.useEffect(()=>{(async()=>{if(!(!t||!n))try{const v=await t.methods.voters(n).call(),T=await t.methods.votingEndTime().call(),j=Math.floor(Date.now()/1e3);v.hasVoted?l(b.VOTED):v.isRegistered&&l(b.REGISTERED),T>j&&f(T-j)}catch(v){console.error("Error loading voting info:",v),w("Failed to load voter information")}})()},[t,n]),a.useEffect(()=>{(async()=>{if(t)try{const v=await t.methods.getCandidateCount().call(),T=await Promise.all(Array.from({length:parseInt(v)},(j,k)=>t.methods.getCandidate(k).call()));u(T.map(j=>({id:j[0],name:j[1],voteCount:j[2]})))}catch(v){console.error("Error loading candidates:",v),w("Failed to load candidates")}finally{h(!1)}})()},[t]);const I=async g=>{if(g.preventDefault(),!!c)try{await o(c),i(""),l(b.VOTED)}catch{}};return x?e.jsx(W,{}):y?e.jsx(D,{message:y}):e.jsxs("div",{className:"vote",children:[e.jsx("h1",{children:"Cast Your Vote"}),s&&e.jsx(D,{message:s}),m===b.VOTED?e.jsx("div",{className:"message",children:"You have already voted"}):e.jsxs("form",{className:"vote-form",onSubmit:I,children:[e.jsx("label",{htmlFor:"candidate",children:"Select Candidate:"}),e.jsxs("select",{id:"candidate",value:c,onChange:g=>i(g.target.value),disabled:d||m!==b.REGISTERED,children:[e.jsx("option",{value:"",children:"--Choose a candidate--"}),r.map(g=>e.jsx("option",{value:g.id,children:g.name},g.id))]}),e.jsx("button",{className:"button",type:"submit",disabled:!c||d||m!==b.REGISTERED,children:d?"Submitting...":"Submit Vote"})]}),p&&e.jsxs("div",{className:"time-remaining",children:["Time remaining: ",Math.floor(p/60)," minutes"]})]})}function ce(){const t=[{candidate:"Candidate 1",votes:120},{candidate:"Candidate 2",votes:150},{candidate:"Candidate 3",votes:90}];return e.jsxs("div",{className:"results",children:[e.jsx("h1",{children:"Election Results"}),e.jsx("ul",{className:"results-list",children:t.map((n,o)=>e.jsxs("li",{className:"result-item",children:[n.candidate,": ",n.votes," votes"]},o))})]})}function de(){const[t,n]=a.useState(""),[o,d]=a.useState(""),s=()=>{console.log(`Registering voter: ${t}, ${o}`)};return e.jsxs("div",{className:"voter-registration",children:[e.jsx("h1",{children:"Voter Registration"}),e.jsxs("div",{className:"registration-form",children:[e.jsx("label",{htmlFor:"name",children:"Name:"}),e.jsx("input",{type:"text",id:"name",value:t,onChange:r=>n(r.target.value)}),e.jsx("label",{htmlFor:"email",children:"Email:"}),e.jsx("input",{type:"email",id:"email",value:o,onChange:r=>d(r.target.value)}),e.jsx("button",{className:"button",onClick:s,children:"Register"})]})]})}function le(){const{contract:t,account:n}=A(),[o,d]=a.useState(""),[s,r]=a.useState(""),[u,c]=a.useState(!1),[i,m]=a.useState(null),[l,p]=a.useState(""),f=async h=>{h.preventDefault(),c(!0),m(null),p("");try{await t.methods.registerVoter(o).send({from:n}),d(""),p("Voter registered successfully!")}catch(y){m(y.message)}finally{c(!1)}},x=async h=>{h.preventDefault(),c(!0),m(null),p("");try{await t.methods.addCandidate(s).send({from:n}),r(""),p("Candidate added successfully!")}catch(y){m(y.message)}finally{c(!1)}};return u?e.jsx(W,{}):e.jsxs("div",{className:"admin-panel",children:[e.jsx("h2",{children:"Admin Panel"}),i&&e.jsx(D,{message:i}),l&&e.jsx("div",{className:"success-message",children:l}),e.jsxs("form",{onSubmit:f,className:"admin-form",children:[e.jsx("h3",{children:"Register Voter"}),e.jsx("input",{type:"text",value:o,onChange:h=>d(h.target.value),placeholder:"Voter Address",required:!0}),e.jsx("button",{type:"submit",disabled:u,children:"Register Voter"})]}),e.jsxs("form",{onSubmit:x,className:"admin-form",children:[e.jsx("h3",{children:"Add Candidate"}),e.jsx("input",{type:"text",value:s,onChange:h=>r(h.target.value),placeholder:"Candidate Name",required:!0}),e.jsx("button",{type:"submit",disabled:u,children:"Add Candidate"})]})]})}function ue(){return e.jsx(se,{children:e.jsx(H,{children:e.jsxs("div",{className:"App",children:[e.jsx(re,{}),e.jsx("main",{className:"container",children:e.jsxs(J,{children:[e.jsx(C,{path:"/",element:e.jsx(ae,{})}),e.jsx(C,{path:"/vote",element:e.jsx(oe,{})}),e.jsx(C,{path:"/register",element:e.jsx(de,{})}),e.jsx(C,{path:"/results",element:e.jsx(ce,{})}),e.jsx(C,{path:"/admin",element:e.jsx(le,{})})]})})]})})})}X.createRoot(document.getElementById("root")).render(e.jsx(K.StrictMode,{children:e.jsx(ue,{})}));
